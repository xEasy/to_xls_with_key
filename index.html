<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>To xls with key by Blowdy</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>To xls with key</h1>
          <h2>Making a xls with keys using spreedsheet</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/Blowdy/to_xls_with_key/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/Blowdy/to_xls_with_key/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/Blowdy/to_xls_with_key" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <p>== to_xls plugin</p>

<p>This simple plugin gives you the ability to call to_xls to a collection of activerecords. The builder options are the same as to_json / to_xml, except for the :include.</p>

<p>== Usage</p>

<p>add below to RAILS_ROOT/config/initializers/mime_types.rb
  Mime::Type.register_alias "text/excel", :xls</p>

<p>@posts = Post.all</p>

<p>#
  #  default are export header and all fileds
  #</p>

<p>@posts.to_xls
  @posts.to_xls(:fields =&gt; you_model_keys)</p>

<p>== Example
  neel ColumnName  model with keys =&gt; :model_name , :column_name ,:print_number</p>

<p>class PostsController &lt; ApplicationController
    def index
      @posts = Post.all</p>

<pre><code>  respond_to do |format|
    format.xls { send_data(@posts.to_xls) }
    #format.xls {
      #  filename = "posts-#{Time.now.strftime("%Y%m%d%H%M%S")}.xls" 
    #  send_data(@posts.to_xls(:fields =&gt; you_database_keys), :type =&gt; "application/excel; charset=utf-8; header=present", :filename =&gt; filename)
    #}
  end
end
</code></pre>

<p>end</p>

<p>== Dependencies</p>

<p>gem install spreadsheet</p>

<p>git clone <a href="http://github.com/jrices/j-provider.git">http://github.com/jrices/j-provider.git</a></p>

<p>== Install</p>

<p>only with git
  git clone <a href="http://github.com/wenke/to_xls_with_key.git">http://github.com/wenke/to_xls_with_key.git</a></p>

<p>== Note</p>

<p>Copyright (c) 2010 <a href="mailto:liangwenke8@gmail.com">liangwenke8@gmail.com</a>, released under the MIT license</p>
        </section>

        <footer>
          To xls with key is maintained by <a href="https://github.com/Blowdy">Blowdy</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>